<?php
session_start();
$SCRIPT = substr($_SERVER['PHP_SELF'],1,strlen($_SERVER['PHP_SELF'])-5);	// script associé à l'onglet qui a téléchargé ce script
require'RequeteBD.php';

// joueur
require'Modele/classe_Joueur.php';
$Joueur=new Joueur;
$CONNEXION_JOUEUR = $Joueur->Cadre_connexion();

/* Fichiers à créer pour un développement d'un futur onglet Ex: batiment spéciaux, missions. Soit X le nom du nouvel onglet
 * X.php à la racine
 * ajouter X dans le tableau $T_onglet
 * Vue/X.css feuille de style en plus de commun.css si besoin
 * Vue/images/onglet_X.png image de l'onglet
 * si l'onglet est de type tableau voir le script pageTaleau
 * */

$T_onglet = array(
//	onglet		=> script à charger
	'index'		=> 'pageJoueur',
	'usines'	=> 'pageTableau',
	'mines'		=> 'pageTableau',
	'entrepots'	=> 'pageTableau',
	'commerce'	=> 'pageTableau');

// sauvegarde de l'état dans la session
if (!isset($_SESSION['IDjoueur'])) $_SESSION['IDjoueur'] = 1; // valeur initalisée lorsque le joueur se connecte. 1->joueur Lambda
$_SESSION['onglet'] = isset($T_onglet[$SCRIPT]) ? $SCRIPT : null;

// construction de la page
ob_start();
if (isset($T_onglet[$SCRIPT])) { // un des onglets appelle cette page
	require"{$T_onglet[$SCRIPT]}.php";
	$cssTable = ($SCRIPT=='index') ? '' : "<link rel=\"stylesheet\" href=\"Vue/table.css\" />\n";
} else { // page d'erreur
	require'pageErreur.php';
	$cssTable = '';
}
$SECTION = ob_get_contents();
ob_end_clean();
?>
<!doctype html>
<html lang="fr">
<head>
	<meta charset="UTF-8" />
	<link rel="shortcut icon" type="image/png" href="Vue/images/resources.ico">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quicksand:400,700">
	<link rel="stylesheet" href="Vue/commun.css" />
	<?=$cssTable?>
	<link rel="stylesheet" href="Vue/<?=$SCRIPT?>.css" />
	<title>Gestion de production pour le jeu Resources</title>
</head>

<body>

<header>
	<p><img src="Vue/images/logo.png" alt="logo officiel">Gestion de production pour le jeu <img src="Vue/images/logo2.png" alt="2e logo officiel"></p>
</header>

<main>

<div id="joueur">
<?=$CONNEXION_JOUEUR?>
</div>

<nav>
	<ul>
<?php
	foreach($T_onglet as $onglet => $valeur)
		echo "\t\t<li><a ",($onglet == $SCRIPT) ? 'id="onglet_actif" ' : '',"href=\"{$onglet}.php\"><img src=\"Vue/images/onglet_{$onglet}.png\" alt=\"onglet {$onglet}\"></a></li>\n";
?>
	</ul>
</nav>

<section>
<?=$SECTION?>
</section>

</main>
<?php include'Vue/pied2page.html';?>
</body>

</html>
