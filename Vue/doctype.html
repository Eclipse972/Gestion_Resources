<?php 
session_start(); // On démarre la session
/*
 * ONGLET_ACTIF est une constante définie dans chaque script associé à l'onglet (qui incsopore appelle ce script)
 * pour ajouter un onglet nommé X il faut créer 4 fichiers
 * X.php à la racine voir index.php pour l'exemple
 * X.css dans Vue
 * onglet_X.png dans Vue/images
 * X.php dans Vue pour l'affichage de la page correspondant à l'onglet
*/
require'Modele/classe_BD.php';
require'Modele/classe_Tableau.php';

$id_selectionné = (int) $_GET['id']; // ID objet de l'onglet sélectionné
$SCRIPT = substr($_SERVER['PHP_SELF'],1,strlen($_SERVER['PHP_SELF'])-5);	// script associé à l'onglet qui a téléchargé cette page

// construction des onglets
ob_start();
echo '<ul>';
$T_onglet = array ('index', 'usines', 'mines', 'entrepots', 'marchandises');	// les onglets
foreach($T_onglet as $valeur)
	echo "\t\t",'<li><a ',($valeur == $SCRIPT) ? 'id="onglet_actif" ' : '','href="',$valeur,'.php">','<img src="Vue/images/onglet_',$valeur,'.png" alt="onglet ',$valeur,'"></a></li>',"\n";
echo "\t</ul>\n";
$NAV = ob_get_contents();
ob_end_clean();

// construction de la page
$T_classe = array (
//		script onglet	=>  classe associée
	'entrepots'		=> 'TEntrepot',
	'marchandises'	=> 'TMarchandise',		
	'usines'		=> 'TUsine',
	'mines'			=> 'TMine');
ob_start();
if (isset($T_classe[$SCRIPT])) {
	$Tableau = new $T_classe[$SCRIPT];
	$Tableau->Afficher_tete();
	$Tableau->Afficher_corps($id_selectionné);
} else echo'Page de connexion en construction';
$SECTION = ob_get_contents();
ob_end_clean();

// joueur
ob_start();
	echo '<a href="index.php">Connexion</a>';
$JOUEUR = ob_get_contents();
ob_end_clean();
?>
<!doctype html>
<html lang="fr">
<head>
	<meta charset="UTF-8" />
	<link rel="shortcut icon" type="image/png" href="Vue/images/resources.ico">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Quicksand:400,700">
	<link rel="stylesheet" href="Vue/commun.css" />
	<link rel="stylesheet" href="Vue/<?=$SCRIPT?>.css" />
	<link rel="stylesheet" href="Vue/table.css" />
	<title>Gestion de production pour le jeu Resources</title>
</head>

<body>

<header>
	<p><img src="Vue/images/logo.png" alt="logo officiel">Gestion de production pour le jeu <img src="Vue/images/logo2.png" alt="2e logo officiel"></p>
</header>

<main>

<div id="joueur">
	<?=$JOUEUR?>	
</div>

<nav>
	<?=$NAV?>
</nav>

<section>
	<?=$SECTION?>
</section>
</main>

<footer>
	<p>Site optimis&eacute; pour <img src="Vue/images/chrome.png" alt="Chrome"> et <img src="Vue/images/firefox.png" alt="Firefox"> - derni&egrave;re mise à jour: 17 novembre 2020</p>
</footer>

</body>

</html>
